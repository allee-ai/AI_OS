# Discord Stimuli Source
# Pulls DMs and mentions via bot, pushes replies

name: discord
type: rest
enabled: false

poll_interval: 30  # Discord is real-time, but we poll for simplicity

auth:
  method: bearer
  token_env: DISCORD_BOT_TOKEN

# Pull: Get messages from DM channels
pull:
  endpoint: https://discord.com/api/v10/users/@me/channels
  method: GET
  
  mapping:
    messages: "$"
    id: "$.id"
    thread_id: "$.id"
    sender_id: "$.recipients[0].id"
    sender_name: "$.recipients[0].username"
    subject: null
    body: "$.last_message_id"  # Need separate call for content

# Push: Send message to channel
push:
  endpoint: https://discord.com/api/v10/channels/{{thread_id}}/messages
  method: POST
  
  body_template:
    content: "{{body}}"
