# Telegram Feeds Source
# Pulls messages via bot API, pushes replies

name: telegram
type: rest
enabled: false

poll_interval: 10  # Telegram supports long polling

auth:
  method: bearer
  token_env: TELEGRAM_BOT_TOKEN

# Pull: Get updates (messages to bot)
pull:
  endpoint: https://api.telegram.org/bot{{token}}/getUpdates
  method: GET
  params:
    timeout: 30
    allowed_updates: '["message"]'
  
  mapping:
    messages: "$.result"
    id: "$.update_id"
    thread_id: "$.message.chat.id"
    sender_id: "$.message.from.id"
    sender_name: "$.message.from.first_name"
    subject: null
    body: "$.message.text"

# Push: Send message
push:
  endpoint: https://api.telegram.org/bot{{token}}/sendMessage
  method: POST
  
  body_template:
    chat_id: "{{to}}"
    text: "{{body}}"
    reply_to_message_id: "{{in_reply_to}}"
