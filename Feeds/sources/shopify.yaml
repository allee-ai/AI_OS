# Shopify Feeds Source
# Pulls orders/customer inquiries, pushes responses

name: shopify
type: rest
enabled: false

poll_interval: 300

auth:
  method: bearer
  token_env: SHOPIFY_ACCESS_TOKEN
  shop_env: SHOPIFY_SHOP  # myshop.myshopify.com

# Pull: Get recent orders
pull:
  endpoint: https://{{shop}}/admin/api/2024-01/orders.json
  method: GET
  params:
    status: "any"
    limit: 20
  
  mapping:
    messages: "$.orders"
    id: "$.id"
    thread_id: "$.id"
    sender_id: "$.customer.id"
    sender_name: "$.customer.first_name"
    subject: "$.name"  # Order #1001
    body: "$.note"

# Push: Add order note
push:
  endpoint: https://{{shop}}/admin/api/2024-01/orders/{{thread_id}}.json
  method: PUT
  
  body_template:
    order:
      note: "{{body}}"
